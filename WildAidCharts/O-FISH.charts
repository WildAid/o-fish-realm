{"exportVersion":6,"dashboards":{"dashboard-1":{"description":"Charts for the O-FISH web app","filters":[],"layout":[{"i":"item-1","w":6,"h":3,"x":0,"y":5},{"i":"item-2","w":2,"h":2,"x":2,"y":0},{"i":"item-3","w":2,"h":2,"x":4,"y":0},{"i":"item-4","w":2,"h":2,"x":6,"y":0},{"i":"item-5","w":2,"h":2,"x":0,"y":0},{"i":"item-6","w":6,"h":3,"x":0,"y":2}],"title":"O-FISH charts","embedding":{}}},"items":{"item-2":{"query":null,"sample":false,"calculatedFields":[],"channels":{"value":{"channelType":"aggregation","field":"_id","inferredType":"String","type":"quantitative","aggregate":"count"}},"chartType":"Number","convertedFields":[],"customisations":{"axes":{"value":{}},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}}},"options":{}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","filters":[],"iconValue":"number","itemType":"chart","meta":{},"missedFields":[],"reductions":{},"title":"Boardings","description":"","lookupFields":[],"queryId":null,"interactiveFiltering":"filter","embedding":{"providerAuthEnabled":true,"providerAuthWhitelist":["date","agency"],"anonymousAuthEnabled":false,"anonymousAuthWhitelist":["date","agency"]}},"item-3":{"query":null,"sample":false,"calculatedFields":[],"channels":{"value":{"channelType":"aggregation","field":"_id","inferredType":"String","type":"quantitative","aggregate":"count"}},"chartType":"Number","convertedFields":[],"customisations":{"axes":{"value":{}},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}}},"options":{}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","filters":[{"fieldPath":"inspection.summary.violations.disposition","type":"String","disabled":false,"settings":{"allOthers":false,"values":["Citation","Warning"]}}],"iconValue":"number","itemType":"chart","meta":{},"missedFields":[],"reductions":{},"title":"All Violations","description":"","lookupFields":[],"queryId":null,"interactiveFiltering":"filter","embedding":{"providerAuthEnabled":true,"providerAuthWhitelist":["date","agency"],"anonymousAuthEnabled":false,"anonymousAuthWhitelist":["date","agency"]}},"item-4":{"query":"[{$group: {\n  _id: null,\n  total: {\n    $sum: 1\n  },\n  compliantTotal: {\n    $sum: {$cond: {\n      'if': {$ifNull: ['$inspection.summary.violations.disposition',\n         0]}, \n      'then': 0,\n      'else': 1}\n    }\n  }\n}}, {$project: {\n  percentage: {\n    $divide: [\n      '$compliantTotal',\n      '$total'\n    ]\n  },\n  compliantTotal: 1,\n  total: 1\n}}]","sample":false,"calculatedFields":[],"channels":{"value":{"channelType":"aggregation","field":"percentage","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Number","convertedFields":[],"customisations":{"axes":{"value":{}},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Custom"},"numberDecimals":{"enabled":true,"value":"2"},"numberMultiplier":{"enabled":true,"value":"100"},"numberSuffix":{"enabled":true,"value":"%"}}},"options":{}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","filters":[],"iconValue":"number","itemType":"chart","meta":{},"missedFields":[],"reductions":{},"title":"Compliance Rate","lookupFields":[],"description":"","queryId":null,"interactiveFiltering":"filter","embedding":{"providerAuthEnabled":true,"providerAuthWhitelist":["agency","date"],"providerAuthInjectedFilterEnabled":false,"providerAuthInjectedFilterFn":"  // Return a filter based on token attributes, e.g:\n  return { ownerId: context.token.sub };","anonymousAuthEnabled":false,"anonymousAuthWhitelist":["date","agency"]}},"item-1":{"query":null,"sample":false,"calculatedFields":[],"channels":{"group":{"channelType":"category","field":"date","inferredType":"Date","type":"nominal","isBinning":false,"temporalBinning":["year","month"]},"group_series_0":{"channelType":"category","field":"vessel.name","inferredType":"String","type":"nominal"},"group_series_1":{"channelType":"category","field":"vessel.permitNumber","inferredType":"String","type":"nominal"},"group_series_2":{"channelType":"category","field":"captain.name","inferredType":"String","type":"nominal"},"group_series_3":{"channelType":"category","field":"inspection.summary.safetyLevel.level","inferredType":"String","type":"nominal"},"value":{"channelType":"aggregation","field":"inspection.summary.violations.disposition","inferredType":"String","type":"quantitative","transformedType":"Number","aggregate":"sum"}},"chartType":"Data Table","convertedFields":[],"customisations":{"axes":{},"channels":{"group":{"labelOverride":{"enabled":true,"value":"Date"},"timePreset":{"enabled":true,"value":"HH:mm"},"dateTimeFormatting":{"enabled":true,"value":"DD-MMM-YYYY HH:mm"}},"group_series_0":{"labelOverride":{"enabled":true,"value":"Vessel Name"}},"group_series_1":{"labelOverride":{"enabled":true,"value":"Permit #"}},"group_series_2":{"labelOverride":{"enabled":true,"value":"Captain"}},"group_series_3":{"labelOverride":{"enabled":true,"value":"Risk"}},"value":{"labelOverride":{"enabled":true,"value":"# Violations"},"numberFormatting":{"enabled":true,"value":"Default"}}},"options":{}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","filters":[],"iconValue":"data-table","itemType":"chart","meta":{},"missedFields":[],"reductions":{"value":[{"dimensionality":1,"field":"inspection.summary.violations","type":"Array length","arguments":[]}]},"title":"Boarding Details","description":"","lookupFields":[],"queryId":null,"interactiveFiltering":"filter","embedding":{"providerAuthEnabled":true,"providerAuthWhitelist":["date","agency"]}},"item-5":{"query":null,"sample":false,"calculatedFields":[{"fieldPath":"isCompliant","rawExpression":"{ $cond: { if: {$eq: ['$inspection.summary.safetyLevel.level','Green']},\nthen: \"Compliant\",\nelse: \"Non-compliant\" } }","derivedMQL":"{\"$cond\":{\"if\":{\"$eq\":[\"$inspection.summary.safetyLevel.level\",\"Green\"]},\"then\":\"Compliant\",\"else\":\"Non-compliant\"}}"}],"channels":{"value":{"channelType":"aggregation","field":"_id","inferredType":"String","type":"quantitative","aggregate":"count"},"label":{"channelType":"category","field":"isCompliant","inferredType":"String","type":"nominal"}},"chartType":"Donut","convertedFields":[],"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":{"domain":["Non-compliant","Compliant"],"range":["#c10422","#16cc62"]}},"dataValueLabels":{"enabled":false,"value":"value"}},"conditionalFormatting":[],"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}},"label":{"labelOverride":{"enabled":true,"value":" "}}}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","filters":[{"fieldPath":"date","type":"Date","disabled":false,"settings":{"type":"relative","absolute":{"from":{"enabled":false,"date":null,"time":"00:00:00","inclusive":false},"to":{"enabled":false,"date":null,"time":"00:00:00","inclusive":false}},"relative":{"from":{"enabled":false,"tense":"last","unit":"days","value":"14"},"until":{"enabled":false,"tense":null,"unit":"days","value":""}},"period":{"direction":"previous","count":"1","unit":"day","includeCurrent":true}}}],"iconValue":"donut","itemType":"chart","meta":{},"missedFields":[],"reductions":{},"title":"Boarding Compliance","lookupFields":[],"description":"","queryId":null,"interactiveFiltering":"filter","embedding":{"providerAuthEnabled":true,"providerAuthWhitelist":["date","agency"],"anonymousAuthEnabled":false,"anonymousAuthWhitelist":["date","agency"]}},"item-6":{"query":null,"sample":false,"calculatedFields":[{"fieldPath":"More Info","rawExpression":"{ $concat: [ \n  \"Vessel: \", \"$vessel.name\",\n  \"     Officer: \", \"$reportingOfficer.name.first\", \" \", \"$reportingOfficer.name.last\",\n  \"     Date: \", { $dateToString: {\n    date: \"$timestamp\",\n    format: \"%Y-%m-%d\",\n} }\n  ] }\n","derivedMQL":"{\"$concat\":[\"Vessel: \",\"$vessel.name\",\"     Officer: \",\"$reportingOfficer.name.first\",\" \",\"$reportingOfficer.name.last\",\"     Date: \",{\"$dateToString\":{\"date\":\"$timestamp\",\"format\":\"%Y-%m-%d\"}}]}"}],"channels":{"geopoint":{"channelType":"geopoint","field":"location","inferredType":"Number","type":"geospatial_array"},"color":{"channelType":"category","field":"inspection.summary.safetyLevel.level","inferredType":"String","type":"nominal"},"detail":{"channelType":"category","field":"More Info","inferredType":"String","type":"nominal","isBinning":false}},"chartType":"Geospatial Scatter","convertedFields":[],"customisations":{"options":{"colorDiscrete":{"enabled":true,"value":{"domain":["Amber","Green","Red"],"range":["#e6b219","#16cc62","#c10422"]}}},"axes":{},"channels":{"geopoint":{},"color":{"labelOverride":{"enabled":true,"value":"Risk"}},"detail":{}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","filters":[],"iconValue":"geo-scatter","itemType":"chart","meta":{"indexes":{"channel":"geopoint","indexLong":0,"indexLat":1},"viewport":{"center":[14.519780046326085,-54.66796875000001],"zoom":3}},"missedFields":[],"reductions":{},"title":"Boardings","description":"","lookupFields":[],"queryId":null,"interactiveFiltering":"filter","embedding":{"providerAuthEnabled":true,"providerAuthWhitelist":["date","agency","_id"],"anonymousAuthEnabled":false,"anonymousAuthWhitelist":["date","agency"]}}},"dataSources":{"data-source-1":{"alias":"ofish.BoardingReports","collection":"BoardingReports","database":"ofish","deployment":"O-FISH","sourceType":"cluster"}},"queries":{}}
